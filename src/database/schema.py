"""Database schema manager for JLTSQL.

Optimized schema with appropriate data types for SQLite.
Auto-generated from JV-Data official specification.

Generated by: scripts/generate_simple_schema.py
Source: 公式JV-Data仕様書 Ver.4.9.0.1

Data Type Optimization:
- INTEGER: Year, MonthDay, Kaiji, Nichiji, RaceNum, Umaban, Kyori, counts, flags
- REAL: Odds, Time, Haron times, prize money
- TEXT: Codes (fixed-length), dates (YYYYMMDD), names

IMPORTANT - Duplicate Handling & Primary Keys:
==============================================

Current Status:
- Tables HAVE PRIMARY KEY constraints defined
- INSERT OR REPLACE is used by default in the importer
- WITH primary keys, duplicate records will be UPDATED instead of created

Primary Keys Implemented:
-------------------------
NL_RA, RT_RA (Race Details):
    PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)

NL_SE, RT_SE (Horse Race Results):
    PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Umaban)

NL_UM (Horse Master):
    PRIMARY KEY (KettoNum)  -- Horse registration number

NL_KS (Jockey Master):
    PRIMARY KEY (KisyuCode)  -- Jockey code

NL_CH (Trainer Master):
    PRIMARY KEY (ChokyosiCode)  -- Trainer code

NL_BN (Owner Master):
    PRIMARY KEY (BanusiCode)  -- Owner code

NL_BR (Breeder Master):
    PRIMARY KEY (BreederCode)  -- Breeder code

NL_TK (Withdrawal Horse):
    PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Num)

NL_O1-O6, RT_O1-O6 (Odds):
    PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Umaban or Kumi)

NL_H1, NL_H6, RT_H1, RT_H6 (Payout):
    PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum) or with Kumi

NL_HR, RT_HR (Refund):
    PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)

Benefits with PRIMARY KEY constraints:
- INSERT OR REPLACE will update existing records instead of duplicating
- Safe to re-run imports multiple times
- Better data integrity
- Prevents duplicate records on re-import
"""

from typing import Dict, List

from src.database.base import BaseDatabase
from src.utils.logger import get_logger

logger = get_logger(__name__)


SCHEMAS = {
    "NL_BN": """
        CREATE TABLE IF NOT EXISTS NL_BN (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            BanusiCode TEXT,
            BanusiName TEXT,
            BanusiName_Co TEXT,
            BanusiNameKana TEXT,
            BanusiNameEng TEXT,
            Fukusyoku TEXT,
            H_SetYear TEXT,
            H_HonSyokinTotal TEXT,
            H_FukaSyokin TEXT,
            H_ChakuKaisu1 TEXT,
            H_ChakuKaisu2 TEXT,
            H_ChakuKaisu3 TEXT,
            H_ChakuKaisu4 TEXT,
            PRIMARY KEY (BanusiCode)
        )
    """,
    "NL_BR": """
        CREATE TABLE IF NOT EXISTS NL_BR (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            BreederCode TEXT,
            BreederName_Co TEXT,
            BreederName TEXT,
            BreederNameKana TEXT,
            BreederNameEng TEXT,
            Address TEXT,
            H_SetYear TEXT,
            H_HonSyokinTotal TEXT,
            H_FukaSyokin TEXT,
            H_ChakuKaisu1 TEXT,
            H_ChakuKaisu2 TEXT,
            H_ChakuKaisu3 TEXT,
            H_ChakuKaisu4 TEXT,
            PRIMARY KEY (BreederCode)
        )
    """,
    "NL_BT": """
        CREATE TABLE IF NOT EXISTS NL_BT (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            KeitoId TEXT,
            KeitoName TEXT,
            Field6 TEXT,
            Field7 TEXT,
            Field8 TEXT
        )
    """,

    "NL_AV": """
        CREATE TABLE IF NOT EXISTS NL_AV (
            RecordSpec TEXT,
            DataKubun TEXT,
            KettoNum TEXT,
            SaleHostName TEXT,
            SaleName TEXT,
            Price TEXT
        )
    """,

    "NL_CC": """
        CREATE TABLE IF NOT EXISTS NL_CC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            AtoKyori TEXT,
            AtoTruckCD TEXT,
            MaeKyori TEXT,
            MaeTruckCD TEXT,
            JiyuCD TEXT
        )
    """,

    "NL_CK": """
        CREATE TABLE IF NOT EXISTS NL_CK (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            KettoNum TEXT,
            Bamei TEXT,
            HeichiHonsyokinTotal TEXT,
            SyogaiHonsyokinTotal TEXT,
            HeichiFukasyokinTotal TEXT,
            SyogaiFukasyokinTotal TEXT,
            HeichiSyutokuTotal TEXT,
            SyogaiSyutokuTotal TEXT,
            TotalChakuCount TEXT,
            ChuoChakuCount TEXT,
            SibaChoChaku TEXT,
            SibaMigiChaku TEXT,
            SibaHidariChaku TEXT,
            DirtChoChaku TEXT,
            DirtMigiChaku TEXT,
            DirtHidariChaku TEXT,
            SyogaiChaku TEXT,
            SibaRyoChaku TEXT,
            SibaYayaChaku TEXT,
            SibaOmoChaku TEXT,
            SibaFuChaku TEXT,
            DirtRyoChaku TEXT,
            DirtYayaChaku TEXT,
            DirtOmoChaku TEXT,
            DirtFuChaku TEXT,
            SyogaiRyoChaku TEXT,
            SyogaiYayaChaku TEXT,
            SyogaiOmoChaku TEXT,
            SyogaiFuChaku TEXT,
            Siba1200IkaChaku TEXT,
            Siba1201_1400Chaku TEXT,
            Siba1401_1600Chaku TEXT,
            Siba1601_1800Chaku TEXT,
            Siba1801_2000Chaku TEXT,
            Siba2001_2200Chaku TEXT,
            Siba2201_2400Chaku TEXT,
            Siba2401_2800Chaku TEXT,
            Siba2801OverChaku TEXT,
            Dirt1200IkaChaku TEXT,
            Dirt1201_1400Chaku TEXT,
            Dirt1401_1600Chaku TEXT,
            Dirt1601_1800Chaku TEXT,
            Dirt1801_2000Chaku TEXT,
            Dirt2001_2200Chaku TEXT,
            Dirt2201_2400Chaku TEXT,
            Dirt2401_2800Chaku TEXT,
            Dirt2801OverChaku TEXT,
            SapporoSibaChaku TEXT,
            HakodateSibaChaku TEXT,
            FukushimaSibaChaku TEXT,
            NiigataSibaChaku TEXT,
            TokyoSibaChaku TEXT,
            NakayamaSibaChaku TEXT,
            ChukyoSibaChaku TEXT,
            KyotoSibaChaku TEXT,
            HanshinSibaChaku TEXT,
            KokuraSibaChaku TEXT,
            SapporoDirtChaku TEXT,
            HakodateDirtChaku TEXT,
            FukushimaDirtChaku TEXT,
            NiigataDirtChaku TEXT,
            TokyoDirtChaku TEXT,
            NakayamaDirtChaku TEXT,
            ChukyoDirtChaku TEXT,
            KyotoDirtChaku TEXT,
            HanshinDirtChaku TEXT,
            KokuraDirtChaku TEXT,
            SapporoSyogaiChaku TEXT,
            HakodateSyogaiChaku TEXT,
            FukushimaSyogaiChaku TEXT,
            NiigataSyogaiChaku TEXT,
            TokyoSyogaiChaku TEXT,
            NakayamaSyogaiChaku TEXT,
            ChukyoSyogaiChaku TEXT,
            KyotoSyogaiChaku TEXT,
            HanshinSyogaiChaku TEXT,
            KokuraSyogaiChaku TEXT,
            KyakusituKeiko TEXT,
            RegisteredRaceCount TEXT,
            KisyuCode TEXT,
            KisyuName TEXT,
            KisyuResultsInfo TEXT,
            ChokyosiCode TEXT,
            ChokyosiName TEXT,
            ChokyosiResultsInfo TEXT,
            BanusiCode TEXT,
            BanusiName TEXT,
            BanusiName_Co TEXT,
            BanusiResultsInfo TEXT,
            BreederCode TEXT,
            BreederName TEXT,
            BreederName_Co TEXT,
            BreederResultsInfo TEXT,
            RecordDelimiter TEXT
        )
    """,
    "NL_CH": """
        CREATE TABLE IF NOT EXISTS NL_CH (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            ChokyosiCode TEXT,
            DelKubun TEXT,
            IssueDate TEXT,
            DelDate TEXT,
            BirthDate TEXT,
            ChokyosiName TEXT,
            ChokyosiNameKana TEXT,
            ChokyosiRyakusyo TEXT,
            ChokyosiNameEng TEXT,
            SexCD TEXT,
            TozaiCD TEXT,
            Syotai TEXT,
            SaikinJyusyo1SaikinJyusyoid TEXT,
            SaikinJyusyo1Hondai TEXT,
            SaikinJyusyo1Ryakusyo10 TEXT,
            SaikinJyusyo1Ryakusyo6 TEXT,
            SaikinJyusyo1Ryakusyo3 TEXT,
            SaikinJyusyo1GradeCD TEXT,
            SaikinJyusyo1SyussoTosu INTEGER,
            SaikinJyusyo1KettoNum TEXT,
            SaikinJyusyo1Bamei TEXT,
            SaikinJyusyo2SaikinJyusyoid TEXT,
            SaikinJyusyo2Hondai TEXT,
            SaikinJyusyo2Ryakusyo10 TEXT,
            SaikinJyusyo2Ryakusyo6 TEXT,
            SaikinJyusyo2Ryakusyo3 TEXT,
            SaikinJyusyo2GradeCD TEXT,
            SaikinJyusyo2SyussoTosu INTEGER,
            SaikinJyusyo2KettoNum TEXT,
            SaikinJyusyo2Bamei TEXT,
            SaikinJyusyo3SaikinJyusyoid TEXT,
            SaikinJyusyo3Hondai TEXT,
            SaikinJyusyo3Ryakusyo10 TEXT,
            SaikinJyusyo3Ryakusyo6 TEXT,
            SaikinJyusyo3Ryakusyo3 TEXT,
            SaikinJyusyo3GradeCD TEXT,
            SaikinJyusyo3SyussoTosu INTEGER,
            SaikinJyusyo3KettoNum TEXT,
            Field41 TEXT,
            Field42 TEXT,
            Field43 TEXT,
            Field44 TEXT,
            Field45 TEXT,
            Field46 TEXT,
            Field47 TEXT,
            Field48 TEXT,
            Field49 TEXT,
            Field50 TEXT,
            Field51 TEXT,
            Field52 TEXT,
            Field53 TEXT,
            Field54 TEXT,
            Field55 TEXT,
            Field56 TEXT,
            Field57 TEXT,
            Field58 TEXT,
            Field59 TEXT,
            Field60 TEXT,
            Field61 TEXT,
            Field62 TEXT,
            PRIMARY KEY (ChokyosiCode)
        )
    """,
    "NL_CS": """
        CREATE TABLE IF NOT EXISTS NL_CS (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            JyoCD TEXT,
            Kyori TEXT,
            TrackCD TEXT,
            KaishuDate TEXT,
            Field8 TEXT,
            Field9 TEXT
        )
    """,
    "NL_DM": """
        CREATE TABLE IF NOT EXISTS NL_DM (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            MakeHM TEXT,
            Umaban1 TEXT,
            DMTime1 TEXT,
            DMGosaP1 TEXT,
            DMGosaM1 TEXT,
            Umaban2 TEXT,
            DMTime2 TEXT
        )
    """,
    "NL_H1": """
        CREATE TABLE IF NOT EXISTS NL_H1 (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            TorokuTosu INTEGER,
            SyussoTosu INTEGER,
            HatubaiFlag1 INTEGER,
            HatubaiFlag2 INTEGER,
            HatubaiFlag3 INTEGER,
            HatubaiFlag4 INTEGER,
            HatubaiFlag5 INTEGER,
            HatubaiFlag6 INTEGER,
            HatubaiFlag7 INTEGER,
            FukuChakuBaraiKey TEXT,
            HenkanUma1 INTEGER,
            HenkanUma2 INTEGER,
            HenkanUma3 INTEGER,
            HenkanUma4 INTEGER,
            HenkanUma5 INTEGER,
            HenkanUma6 INTEGER,
            HenkanUma7 INTEGER,
            HenkanUma8 INTEGER,
            HenkanUma9 INTEGER,
            HenkanUma10 INTEGER,
            HenkanUma11 INTEGER,
            HenkanUma12 INTEGER,
            HenkanUma13 INTEGER,
            HenkanUma14 INTEGER,
            HenkanUma15 INTEGER,
            HenkanUma16 INTEGER,
            HenkanUma17 INTEGER,
            HenkanUma18 INTEGER,
            HenkanUma19 INTEGER,
            HenkanUma20 INTEGER,
            HenkanUma21 INTEGER,
            HenkanUma22 INTEGER,
            HenkanUma23 INTEGER,
            HenkanUma24 INTEGER,
            HenkanUma25 INTEGER,
            HenkanUma26 INTEGER,
            HenkanUma27 INTEGER,
            HenkanUma28 INTEGER,
            HenkanWaku1 INTEGER,
            HenkanWaku2 INTEGER,
            HenkanWaku3 INTEGER,
            HenkanWaku4 INTEGER,
            HenkanWaku5 INTEGER,
            HenkanWaku6 INTEGER,
            HenkanWaku7 INTEGER,
            HenkanWaku8 INTEGER,
            HenkanDoWaku1 INTEGER,
            HenkanDoWaku2 INTEGER,
            HenkanDoWaku3 INTEGER,
            HenkanDoWaku4 INTEGER,
            HenkanDoWaku5 INTEGER,
            HenkanDoWaku6 INTEGER,
            HenkanDoWaku7 INTEGER,
            HenkanDoWaku8 INTEGER,
            HyoTotal1 REAL,
            HyoTotal2 REAL,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)
        )
    """,
    "NL_H6": """
        CREATE TABLE IF NOT EXISTS NL_H6 (
            RecordSpec TEXT,
            DataKubun TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Hyo REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "NL_HC": """
        CREATE TABLE IF NOT EXISTS NL_HC (
            RecordSpec TEXT,
            ChokyosiCode TEXT,
            Num TEXT,
            SetYear TEXT,
            HonSyokinHeichi TEXT,
            HonSyokinSyogai TEXT,
            FukaSyokinHeichi TEXT,
            FukaSyokinSyogai TEXT,
            HeichiChakukaisu1 TEXT,
            HeichiChakukaisu2 TEXT,
            HeichiChakukaisu3 TEXT,
            HeichiChakukaisu4 TEXT,
            HeichiChakukaisu5 TEXT,
            HeichiChakukaisu6 TEXT,
            SyogaiChakukaisu1 TEXT,
            SyogaiChakukaisu2 TEXT,
            SyogaiChakukaisu3 TEXT,
            SyogaiChakukaisu4 TEXT,
            SyogaiChakukaisu5 TEXT
        )
    """,
    "NL_HN": """
        CREATE TABLE IF NOT EXISTS NL_HN (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            TresenKubun TEXT,
            ChokyoDate TEXT,
            ChokyoTime TEXT,
            KettoNum TEXT,
            HaronTime4 TEXT,
            LapTime4 TEXT,
            HaronTime3 TEXT,
            LapTime3 TEXT,
            HaronTime2 TEXT,
            LapTime2 TEXT,
            LapTime1 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT
        )
    """,
    "NL_HR": """
        CREATE TABLE IF NOT EXISTS NL_HR (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            TorokuTosu INTEGER,
            SyussoTosu INTEGER,
            FuseirituFlag1 INTEGER,
            FuseirituFlag2 INTEGER,
            FuseirituFlag3 INTEGER,
            FuseirituFlag4 INTEGER,
            FuseirituFlag5 INTEGER,
            FuseirituFlag6 INTEGER,
            FuseirituFlag7 INTEGER,
            FuseirituFlag8 INTEGER,
            FuseirituFlag9 INTEGER,
            TokubaraiFlag1 INTEGER,
            TokubaraiFlag2 INTEGER,
            TokubaraiFlag3 INTEGER,
            TokubaraiFlag4 INTEGER,
            TokubaraiFlag5 INTEGER,
            TokubaraiFlag6 INTEGER,
            TokubaraiFlag7 INTEGER,
            TokubaraiFlag8 INTEGER,
            TokubaraiFlag9 INTEGER,
            HenkanFlag1 INTEGER,
            HenkanFlag2 INTEGER,
            HenkanFlag3 INTEGER,
            HenkanFlag4 INTEGER,
            HenkanFlag5 INTEGER,
            HenkanFlag6 INTEGER,
            HenkanFlag7 INTEGER,
            HenkanFlag8 INTEGER,
            HenkanFlag9 INTEGER,
            HenkanUma1 INTEGER,
            HenkanUma2 INTEGER,
            HenkanUma3 INTEGER,
            HenkanUma4 INTEGER,
            HenkanUma5 INTEGER,
            HenkanUma6 INTEGER,
            HenkanUma7 INTEGER,
            HenkanUma8 INTEGER,
            HenkanUma9 INTEGER,
            HenkanUma10 INTEGER,
            HenkanUma11 INTEGER,
            HenkanUma12 INTEGER,
            HenkanUma13 INTEGER,
            HenkanUma14 INTEGER,
            HenkanUma15 INTEGER,
            HenkanUma16 INTEGER,
            HenkanUma17 INTEGER,
            HenkanUma18 INTEGER,
            HenkanUma19 INTEGER,
            HenkanUma20 INTEGER,
            HenkanUma21 INTEGER,
            HenkanUma22 INTEGER,
            HenkanUma23 INTEGER,
            HenkanUma24 INTEGER,
            HenkanUma25 INTEGER,
            HenkanUma26 INTEGER,
            HenkanUma27 INTEGER,
            HenkanUma28 INTEGER,
            HenkanWaku1 INTEGER,
            HenkanWaku2 INTEGER,
            HenkanWaku3 INTEGER,
            HenkanWaku4 INTEGER,
            HenkanWaku5 INTEGER,
            HenkanWaku6 INTEGER,
            HenkanWaku7 INTEGER,
            HenkanWaku8 INTEGER,
            HenkanDoWaku1 INTEGER,
            HenkanDoWaku2 INTEGER,
            HenkanDoWaku3 INTEGER,
            HenkanDoWaku4 INTEGER,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)
        )
    """,
    "NL_HS": """
        CREATE TABLE IF NOT EXISTS NL_HS (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            KettoNum TEXT,
            HansyokuFNum TEXT,
            HansyokuMNum TEXT,
            BirthYear TEXT,
            SaleCode TEXT,
            SaleHostName TEXT,
            SaleName TEXT,
            FromDate TEXT,
            ToDate TEXT,
            Barei TEXT,
            Price TEXT,
            Field15 TEXT
        )
    """,
    "NL_HY": """
        CREATE TABLE IF NOT EXISTS NL_HY (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Bamei TEXT,
            Field5 TEXT,
            Field6 TEXT,
            Field7 TEXT
        )
    """,
    "NL_JG": """
        CREATE TABLE IF NOT EXISTS NL_JG (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            Umaban TEXT,
            Bamei TEXT,
            JiyuKubun TEXT,
            Field14 TEXT,
            Field15 TEXT
        )
    """,

    "NL_JC": """
        CREATE TABLE IF NOT EXISTS NL_JC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            Umaban TEXT,
            Bamei TEXT,
            AtoFutan TEXT,
            AtoKisyuCode TEXT,
            AtoKisyuName TEXT,
            AtoMinaraiCD TEXT,
            MaeFutan TEXT,
            MaeKisyuCode TEXT,
            MaeKisyuName TEXT,
            MaeMinaraiCD TEXT
        )
    """,
    "NL_KS": """
        CREATE TABLE IF NOT EXISTS NL_KS (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            KisyuCode TEXT,
            DelKubun TEXT,
            IssueDate TEXT,
            DelDate TEXT,
            BirthDate TEXT,
            KisyuName TEXT,
            reserved TEXT,
            KisyuNameKana TEXT,
            KisyuRyakusyo TEXT,
            KisyuNameEng TEXT,
            SexCD TEXT,
            SikakuCD TEXT,
            MinaraiCD TEXT,
            TozaiCD TEXT,
            Syotai TEXT,
            ChokyosiCode TEXT,
            ChokyosiRyakusyo TEXT,
            HatuKiJyo1Hatukijyoid TEXT,
            HatuKiJyo1SyussoTosu INTEGER,
            HatuKiJyo1KettoNum TEXT,
            HatuKiJyo1Bamei TEXT,
            HatuKiJyo1KakuteiJyuni INTEGER,
            HatuKiJyo1IJyoCD TEXT,
            HatuKiJyo2Hatukijyoid TEXT,
            HatuKiJyo2SyussoTosu INTEGER,
            HatuKiJyo2KettoNum TEXT,
            HatuKiJyo2Bamei TEXT,
            HatuKiJyo2KakuteiJyuni INTEGER,
            HatuKiJyo2IJyoCD TEXT,
            HatuSyori1Hatusyoriid TEXT,
            HatuSyori1SyussoTosu INTEGER,
            HatuSyori1KettoNum TEXT,
            HatuSyori1Bamei TEXT,
            HatuSyori2Hatusyoriid TEXT,
            HatuSyori2SyussoTosu INTEGER,
            HatuSyori2KettoNum TEXT,
            HatuSyori2Bamei TEXT,
            SaikinJyusyo1SaikinJyusyoid TEXT,
            SaikinJyusyo1Hondai TEXT,
            SaikinJyusyo1Ryakusyo10 TEXT,
            SaikinJyusyo1Ryakusyo6 TEXT,
            SaikinJyusyo1Ryakusyo3 TEXT,
            SaikinJyusyo1GradeCD TEXT,
            SaikinJyusyo1SyussoTosu INTEGER,
            SaikinJyusyo1KettoNum TEXT,
            SaikinJyusyo1Bamei TEXT,
            SaikinJyusyo2SaikinJyusyoid TEXT,
            SaikinJyusyo2Hondai TEXT,
            SaikinJyusyo2Ryakusyo10 TEXT,
            SaikinJyusyo2Ryakusyo6 TEXT,
            SaikinJyusyo2Ryakusyo3 TEXT,
            SaikinJyusyo2GradeCD TEXT,
            SaikinJyusyo2SyussoTosu INTEGER,
            SaikinJyusyo2KettoNum TEXT,
            SaikinJyusyo2Bamei TEXT,
            SaikinJyusyo3SaikinJyusyoid TEXT,
            SaikinJyusyo3Hondai TEXT,
            SaikinJyusyo3Ryakusyo10 TEXT,
            SaikinJyusyo3Ryakusyo6 TEXT,
            SaikinJyusyo3Ryakusyo3 TEXT,
            SaikinJyusyo3GradeCD TEXT,
            SaikinJyusyo3SyussoTosu INTEGER,
            SaikinJyusyo3KettoNum TEXT,
            Field66 TEXT,
            Field67 TEXT,
            Field68 TEXT,
            Field69 TEXT,
            Field70 TEXT,
            Field71 TEXT,
            Field72 TEXT,
            Field73 TEXT,
            Field74 TEXT,
            Field75 TEXT,
            Field76 TEXT,
            Field77 TEXT,
            Field78 TEXT,
            Field79 TEXT,
            PRIMARY KEY (KisyuCode)
        )
    """,
    "NL_O1": """
        CREATE TABLE IF NOT EXISTS NL_O1 (
            RecordSpec TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Umaban INTEGER,
            TanOdds REAL,
            TanNinki INTEGER,
            FukuOddsLow REAL,
            FukuOddsHigh REAL,
            FukuNinki INTEGER,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            Field21 TEXT,
            Field22 TEXT,
            Field23 TEXT,
            Field24 TEXT,
            Field25 TEXT,
            Field26 TEXT,
            Field27 TEXT,
            Field28 TEXT,
            Field29 TEXT,
            Field30 TEXT,
            Field31 TEXT,
            Field32 TEXT,
            Field33 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Umaban)
        )
    """,
    "NL_O2": """
        CREATE TABLE IF NOT EXISTS NL_O2 (
            RecordSpec TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "NL_O3": """
        CREATE TABLE IF NOT EXISTS NL_O3 (
            RecordSpec TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            OddsLow REAL,
            OddsHigh REAL,
            Ninki INTEGER,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "NL_O4": """
        CREATE TABLE IF NOT EXISTS NL_O4 (
            RecordSpec TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "NL_O5": """
        CREATE TABLE IF NOT EXISTS NL_O5 (
            RecordSpec TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "NL_O6": """
        CREATE TABLE IF NOT EXISTS NL_O6 (
            RecordSpec TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "NL_RA": """
        CREATE TABLE IF NOT EXISTS NL_RA (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            YoubiCD TEXT,
            TokuNum TEXT,
            Hondai TEXT,
            Fukudai TEXT,
            Kakko TEXT,
            HondaiEng TEXT,
            FukudaiEng TEXT,
            KakkoEng TEXT,
            Ryakusyo10 TEXT,
            Ryakusyo6 TEXT,
            Ryakusyo3 TEXT,
            Kubun TEXT,
            Nkai TEXT,
            GradeCD TEXT,
            GradeCDBefore TEXT,
            SyubetuCD TEXT,
            KigoCD TEXT,
            JyuryoCD TEXT,
            JyokenCD1 TEXT,
            JyokenCD2 TEXT,
            JyokenCD3 TEXT,
            JyokenCD4 TEXT,
            JyokenCD5 TEXT,
            JyokenName TEXT,
            Kyori INTEGER,
            KyoriBefore INTEGER,
            TrackCD TEXT,
            TrackCDBefore TEXT,
            CourseKubunCD TEXT,
            CourseKubunCDBefore TEXT,
            Honsyokin1 REAL,
            Honsyokin2 REAL,
            Honsyokin3 REAL,
            Honsyokin4 REAL,
            Honsyokin5 REAL,
            Honsyokin6 REAL,
            Honsyokin7 REAL,
            HonsyokinBefore1 REAL,
            HonsyokinBefore2 REAL,
            HonsyokinBefore3 REAL,
            HonsyokinBefore4 REAL,
            HonsyokinBefore5 REAL,
            Fukasyokin1 REAL,
            Fukasyokin2 REAL,
            Fukasyokin3 REAL,
            Fukasyokin4 REAL,
            Fukasyokin5 REAL,
            FukasyokinBefore1 REAL,
            FukasyokinBefore2 REAL,
            FukasyokinBefore3 REAL,
            HassoTime TEXT,
            HassoTimeBefore TEXT,
            TorokuTosu INTEGER,
            SyussoTosu INTEGER,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)
        )
    """,
    "NL_RC": """
        CREATE TABLE IF NOT EXISTS NL_RC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            RecInfoKubun TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            TokuNum TEXT,
            Hondai TEXT,
            GradeCD TEXT,
            SyubetuCD_TrackCD TEXT,
            Kyori TEXT,
            RecKubun TEXT,
            RecTime TEXT,
            TenkoCD TEXT,
            SibaBabaCD TEXT,
            DirtBabaCD TEXT,
            RecUmaKettoNum1 TEXT,
            RecUmaBamei1 TEXT,
            RecUmaUmaKigoCD1 TEXT,
            RecUmaSexCD1 TEXT,
            RecUmaChokyosiCode1 TEXT,
            RecUmaChokyosiName1 TEXT,
            RecUmaFutan1 TEXT,
            RecUmaKisyuCode1 TEXT,
            RecUmaKisyuName1 TEXT,
            RecUmaKettoNum2 TEXT,
            RecUmaBamei2 TEXT,
            RecUmaUmaKigoCD2 TEXT
        )
    """,
    "NL_SE": """
        CREATE TABLE IF NOT EXISTS NL_SE (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Wakuban INTEGER,
            Umaban INTEGER,
            KettoNum TEXT,
            Bamei TEXT,
            UmaKigoCD TEXT,
            SexCD TEXT,
            HinsyuCD TEXT,
            KeiroCD TEXT,
            Barei INTEGER,
            TozaiCD TEXT,
            ChokyosiCode TEXT,
            ChokyosiRyakusyo TEXT,
            BanusiCode TEXT,
            BanusiName TEXT,
            Fukusyoku TEXT,
            reserved1 TEXT,
            Futan REAL,
            FutanBefore REAL,
            Blinker TEXT,
            reserved2 TEXT,
            KisyuCode TEXT,
            KisyuCodeBefore TEXT,
            KisyuRyakusyo TEXT,
            KisyuRyakusyoBefore TEXT,
            MinaraiCD TEXT,
            MinaraiCDBefore TEXT,
            BaTaijyu REAL,
            ZogenFugo TEXT,
            ZogenSa REAL,
            IJyoCD TEXT,
            NyusenJyuni INTEGER,
            KakuteiJyuni INTEGER,
            DochakuKubun TEXT,
            DochakuTosu INTEGER,
            Time REAL,
            ChakusaCD TEXT,
            ChakusaCDP TEXT,
            ChakusaCDPP TEXT,
            Jyuni1c INTEGER,
            Jyuni2c INTEGER,
            Jyuni3c INTEGER,
            Jyuni4c INTEGER,
            Odds REAL,
            Ninki INTEGER,
            Honsyokin REAL,
            Fukasyokin REAL,
            reserved3 TEXT,
            reserved4 TEXT,
            HaronTimeL4 REAL,
            HaronTimeL3 REAL,
            KettoNum1 TEXT,
            Bamei1 TEXT,
            TimeDiff REAL,
            RecordUpKubun TEXT,
            DMKubun TEXT,
            DMTime REAL,
            DMGosaP REAL,
            DMGosaM REAL,
            DMJyuni INTEGER,
            KyakusituKubun TEXT,
            reserved5 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Umaban)
        )
    """,
    "NL_SK": """
        CREATE TABLE IF NOT EXISTS NL_SK (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            BirthDate TEXT,
            SexCD TEXT,
            HinsyuCD TEXT,
            KeiroCD TEXT,
            SankuMochiKubun TEXT,
            ImportYear TEXT,
            BreederCode TEXT,
            SanchiName TEXT,
            FNum TEXT,
            MNum TEXT,
            FFNum TEXT
        )
    """,

    "NL_TC": """
        CREATE TABLE IF NOT EXISTS NL_TC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            AtoJi TEXT,
            AtoFun TEXT,
            MaeJi TEXT,
            MaeFun TEXT
        )
    """,
    "NL_TK": """
        CREATE TABLE IF NOT EXISTS NL_TK (
            RecordSpec TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            Num TEXT,
            KettoNum TEXT,
            Bamei TEXT,
            UmaKigoCD TEXT,
            SexCD TEXT,
            TozaiCD TEXT,
            ChokyosiCode TEXT,
            ChokyosiRyakusyo TEXT,
            Futan TEXT,
            Koryu TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            Field21 TEXT,
            Field22 TEXT,
            Field23 TEXT,
            Field24 TEXT,
            Field25 TEXT,
            Field26 TEXT,
            Field27 TEXT,
            Field28 TEXT,
            Field29 TEXT,
            Field30 TEXT,
            Field31 TEXT,
            Field32 TEXT,
            Field33 TEXT,
            Field34 TEXT,
            Field35 TEXT,
            Field36 TEXT,
            Field37 TEXT,
            Field38 TEXT,
            Field39 TEXT,
            Field40 TEXT,
            Field41 TEXT,
            Field42 TEXT,
            Field43 TEXT,
            Field44 TEXT,
            Field45 TEXT,
            Field46 TEXT,
            Field47 TEXT,
            Field48 TEXT,
            Field49 TEXT,
            Field50 TEXT,
            Field51 TEXT,
            Field52 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Num)
        )
    """,
    "NL_TM": """
        CREATE TABLE IF NOT EXISTS NL_TM (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            MakeHM TEXT,
            Umaban1 TEXT,
            TMScore1 TEXT,
            Umaban2 TEXT,
            TMScore2 TEXT
        )
    """,
    "NL_UM": """
        CREATE TABLE IF NOT EXISTS NL_UM (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            KettoNum TEXT,
            DelKubun TEXT,
            RegDate TEXT,
            DelDate TEXT,
            BirthDate TEXT,
            Bamei TEXT,
            BameiKana TEXT,
            BameiEng TEXT,
            ZaikyuFlag INTEGER,
            Reserved TEXT,
            UmaKigoCD TEXT,
            SexCD TEXT,
            HinsyuCD TEXT,
            KeiroCD TEXT,
            Ketto3InfoHansyokuNum1 TEXT,
            Ketto3InfoBamei1 TEXT,
            Ketto3InfoHansyokuNum2 TEXT,
            Ketto3InfoBamei2 TEXT,
            Ketto3InfoHansyokuNum3 TEXT,
            Ketto3InfoBamei3 TEXT,
            Ketto3InfoHansyokuNum4 TEXT,
            Ketto3InfoBamei4 TEXT,
            Ketto3InfoHansyokuNum5 TEXT,
            Ketto3InfoBamei5 TEXT,
            Ketto3InfoHansyokuNum6 TEXT,
            Ketto3InfoBamei6 TEXT,
            Ketto3InfoHansyokuNum7 TEXT,
            Ketto3InfoBamei7 TEXT,
            Ketto3InfoHansyokuNum8 TEXT,
            Ketto3InfoBamei8 TEXT,
            Ketto3InfoHansyokuNum9 TEXT,
            Ketto3InfoBamei9 TEXT,
            Ketto3InfoHansyokuNum10 TEXT,
            Ketto3InfoBamei10 TEXT,
            Ketto3InfoHansyokuNum11 TEXT,
            Ketto3InfoBamei11 TEXT,
            Ketto3InfoHansyokuNum12 TEXT,
            Ketto3InfoBamei12 TEXT,
            Ketto3InfoHansyokuNum13 TEXT,
            Ketto3InfoBamei13 TEXT,
            Ketto3InfoHansyokuNum14 TEXT,
            Ketto3InfoBamei14 TEXT,
            TozaiCD TEXT,
            ChokyosiCode TEXT,
            ChokyosiRyakusyo TEXT,
            Syotai TEXT,
            BreederCode TEXT,
            BreederName TEXT,
            SanchiName TEXT,
            BanusiCode TEXT,
            BanusiName TEXT,
            RuikeiHonsyoHeiti REAL,
            RuikeiHonsyoSyogai REAL,
            RuikeiFukaHeichi REAL,
            RuikeiFukaSyogai REAL,
            RuikeiSyutokuHeichi REAL,
            RuikeiSyutokuSyogai REAL,
            reserved1 TEXT,
            PRIMARY KEY (KettoNum)
        )
    """,

    "NL_WC": """
        CREATE TABLE IF NOT EXISTS NL_WC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            TresenKubun TEXT,
            ChokyoDate TEXT,
            ChokyoTime TEXT,
            KettoNum TEXT,
            Course TEXT,
            BabaMawari TEXT,
            reserved TEXT,
            HaronTime10Total TEXT,
            LapTime_2000M_1800M TEXT,
            HaronTime9Total TEXT,
            LapTime_1800M_1600M TEXT,
            HaronTime8Total TEXT,
            LapTime_1600M_1400M TEXT,
            HaronTime7Total TEXT,
            LapTime_1400M_1200M TEXT,
            HaronTime6Total TEXT,
            LapTime_1200M_1000M TEXT,
            HaronTime5Total TEXT,
            LapTime_1000M_800M TEXT,
            HaronTime4Total TEXT,
            LapTime_800M_600M TEXT,
            HaronTime3Total TEXT,
            LapTime_600M_400M TEXT,
            HaronTime2Total TEXT,
            LapTime_400M_200M TEXT,
            LapTime_200M_0M TEXT
        )
    """,

    "NL_WE": """
        CREATE TABLE IF NOT EXISTS NL_WE (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            HappyoTime TEXT,
            HenkoID TEXT,
            TenkoState TEXT,
            SibaBabaState TEXT,
            DirtBabaState TEXT,
            TenkoState2 TEXT,
            SibaBabaState2 TEXT,
            DirtBabaState2 TEXT
        )
    """,

    "NL_WH": """
        CREATE TABLE IF NOT EXISTS NL_WH (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            HappyoTime TEXT,
            HenkoID TEXT,
            AtoTenkoCD TEXT,
            AtoSibaBabaCD TEXT,
            AtoDirtBabaCD TEXT,
            MaeTenkoCD TEXT,
            MaeSibaBabaCD TEXT,
            MaeDirtBabaCD TEXT
        )
    """,
    "NL_WF": """
        CREATE TABLE IF NOT EXISTS NL_WF (
            RecordSpec TEXT,
            Year TEXT,
            MonthDay TEXT,
            Kumi TEXT,
            PayJyushosiki TEXT,
            TekichuHyo TEXT,
            Field7 TEXT,
            Field8 TEXT,
            Field9 TEXT,
            Field10 TEXT,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            Field21 TEXT,
            Field22 TEXT,
            Field23 TEXT,
            Field24 TEXT,
            Field25 TEXT
        )
    """,
    "NL_YS": """
        CREATE TABLE IF NOT EXISTS NL_YS (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            YoubiCD TEXT,
            Jyusyo1TokuNum TEXT,
            Jyusyo1Hondai TEXT,
            Jyusyo1Ryakusyo10 TEXT,
            Jyusyo1Ryakusyo6 TEXT,
            Jyusyo1Ryakusyo3 TEXT,
            Jyusyo1Nkai TEXT,
            Jyusyo1GradeCD TEXT,
            Jyusyo1SyubetuCD TEXT,
            Jyusyo1KigoCD TEXT,
            Jyusyo1JyuryoCD TEXT,
            Jyusyo1Kyori TEXT,
            Jyusyo1TrackCD TEXT,
            Jyusyo2TokuNum TEXT,
            Jyusyo2Hondai TEXT
        )
    """,

    # RT_ tables (Real-time data)
    "RT_AV": """
        CREATE TABLE IF NOT EXISTS RT_AV (
            KettoNum TEXT,
            SaleHostName TEXT,
            SaleName TEXT,
            Price TEXT
        )
    """,
    "RT_CC": """
        CREATE TABLE IF NOT EXISTS RT_CC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            AtoKyori TEXT,
            AtoTruckCD TEXT,
            MaeKyori TEXT,
            MaeTruckCD TEXT,
            JiyuCD TEXT
        )
    """,
    "RT_DM": """
        CREATE TABLE IF NOT EXISTS RT_DM (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            MakeHM TEXT,
            Umaban1 TEXT,
            DMTime1 TEXT,
            DMGosaP1 TEXT,
            DMGosaM1 TEXT,
            Umaban2 TEXT,
            DMTime2 TEXT
        )
    """,
    "RT_H1": """
        CREATE TABLE IF NOT EXISTS RT_H1 (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            TorokuTosu INTEGER,
            SyussoTosu INTEGER,
            HatubaiFlag1 INTEGER,
            HatubaiFlag2 INTEGER,
            HatubaiFlag3 INTEGER,
            HatubaiFlag4 INTEGER,
            HatubaiFlag5 INTEGER,
            HatubaiFlag6 INTEGER,
            HatubaiFlag7 INTEGER,
            FukuChakuBaraiKey TEXT,
            HenkanUma1 INTEGER,
            HenkanUma2 INTEGER,
            HenkanUma3 INTEGER,
            HenkanUma4 INTEGER,
            HenkanUma5 INTEGER,
            HenkanUma6 INTEGER,
            HenkanUma7 INTEGER,
            HenkanUma8 INTEGER,
            HenkanUma9 INTEGER,
            HenkanUma10 INTEGER,
            HenkanUma11 INTEGER,
            HenkanUma12 INTEGER,
            HenkanUma13 INTEGER,
            HenkanUma14 INTEGER,
            HenkanUma15 INTEGER,
            HenkanUma16 INTEGER,
            HenkanUma17 INTEGER,
            HenkanUma18 INTEGER,
            HenkanUma19 INTEGER,
            HenkanUma20 INTEGER,
            HenkanUma21 INTEGER,
            HenkanUma22 INTEGER,
            HenkanUma23 INTEGER,
            HenkanUma24 INTEGER,
            HenkanUma25 INTEGER,
            HenkanUma26 INTEGER,
            HenkanUma27 INTEGER,
            HenkanUma28 INTEGER,
            HenkanWaku1 INTEGER,
            HenkanWaku2 INTEGER,
            HenkanWaku3 INTEGER,
            HenkanWaku4 INTEGER,
            HenkanWaku5 INTEGER,
            HenkanWaku6 INTEGER,
            HenkanWaku7 INTEGER,
            HenkanWaku8 INTEGER,
            HenkanDoWaku1 INTEGER,
            HenkanDoWaku2 INTEGER,
            HenkanDoWaku3 INTEGER,
            HenkanDoWaku4 INTEGER,
            HenkanDoWaku5 INTEGER,
            HenkanDoWaku6 INTEGER,
            HenkanDoWaku7 INTEGER,
            HenkanDoWaku8 INTEGER,
            HyoTotal1 REAL,
            HyoTotal2 REAL,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)
        )
    """,
    "RT_H6": """
        CREATE TABLE IF NOT EXISTS RT_H6 (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Hyo REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "RT_HR": """
        CREATE TABLE IF NOT EXISTS RT_HR (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            TorokuTosu INTEGER,
            SyussoTosu INTEGER,
            FuseirituFlag1 INTEGER,
            FuseirituFlag2 INTEGER,
            FuseirituFlag3 INTEGER,
            FuseirituFlag4 INTEGER,
            FuseirituFlag5 INTEGER,
            FuseirituFlag6 INTEGER,
            FuseirituFlag7 INTEGER,
            FuseirituFlag8 INTEGER,
            FuseirituFlag9 INTEGER,
            TokubaraiFlag1 INTEGER,
            TokubaraiFlag2 INTEGER,
            TokubaraiFlag3 INTEGER,
            TokubaraiFlag4 INTEGER,
            TokubaraiFlag5 INTEGER,
            TokubaraiFlag6 INTEGER,
            TokubaraiFlag7 INTEGER,
            TokubaraiFlag8 INTEGER,
            TokubaraiFlag9 INTEGER,
            HenkanFlag1 INTEGER,
            HenkanFlag2 INTEGER,
            HenkanFlag3 INTEGER,
            HenkanFlag4 INTEGER,
            HenkanFlag5 INTEGER,
            HenkanFlag6 INTEGER,
            HenkanFlag7 INTEGER,
            HenkanFlag8 INTEGER,
            HenkanFlag9 INTEGER,
            HenkanUma1 INTEGER,
            HenkanUma2 INTEGER,
            HenkanUma3 INTEGER,
            HenkanUma4 INTEGER,
            HenkanUma5 INTEGER,
            HenkanUma6 INTEGER,
            HenkanUma7 INTEGER,
            HenkanUma8 INTEGER,
            HenkanUma9 INTEGER,
            HenkanUma10 INTEGER,
            HenkanUma11 INTEGER,
            HenkanUma12 INTEGER,
            HenkanUma13 INTEGER,
            HenkanUma14 INTEGER,
            HenkanUma15 INTEGER,
            HenkanUma16 INTEGER,
            HenkanUma17 INTEGER,
            HenkanUma18 INTEGER,
            HenkanUma19 INTEGER,
            HenkanUma20 INTEGER,
            HenkanUma21 INTEGER,
            HenkanUma22 INTEGER,
            HenkanUma23 INTEGER,
            HenkanUma24 INTEGER,
            HenkanUma25 INTEGER,
            HenkanUma26 INTEGER,
            HenkanUma27 INTEGER,
            HenkanUma28 INTEGER,
            HenkanWaku1 INTEGER,
            HenkanWaku2 INTEGER,
            HenkanWaku3 INTEGER,
            HenkanWaku4 INTEGER,
            HenkanWaku5 INTEGER,
            HenkanWaku6 INTEGER,
            HenkanWaku7 INTEGER,
            HenkanWaku8 INTEGER,
            HenkanDoWaku1 INTEGER,
            HenkanDoWaku2 INTEGER,
            HenkanDoWaku3 INTEGER,
            HenkanDoWaku4 INTEGER,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)
        )
    """,
    "RT_JC": """
        CREATE TABLE IF NOT EXISTS RT_JC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            Umaban TEXT,
            Bamei TEXT,
            AtoFutan TEXT,
            AtoKisyuCode TEXT,
            AtoKisyuName TEXT,
            AtoMinaraiCD TEXT,
            MaeFutan TEXT,
            MaeKisyuCode TEXT,
            MaeKisyuName TEXT,
            MaeMinaraiCD TEXT
        )
    """,
    "RT_O1": """
        CREATE TABLE IF NOT EXISTS RT_O1 (
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Umaban INTEGER,
            TanOdds REAL,
            TanNinki INTEGER,
            FukuOddsLow REAL,
            FukuOddsHigh REAL,
            FukuNinki INTEGER,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            Field21 TEXT,
            Field22 TEXT,
            Field23 TEXT,
            Field24 TEXT,
            Field25 TEXT,
            Field26 TEXT,
            Field27 TEXT,
            Field28 TEXT,
            Field29 TEXT,
            Field30 TEXT,
            Field31 TEXT,
            Field32 TEXT,
            Field33 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Umaban)
        )
    """,
    "RT_O2": """
        CREATE TABLE IF NOT EXISTS RT_O2 (
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "RT_O3": """
        CREATE TABLE IF NOT EXISTS RT_O3 (
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            OddsLow REAL,
            OddsHigh REAL,
            Ninki INTEGER,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            Field20 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "RT_O4": """
        CREATE TABLE IF NOT EXISTS RT_O4 (
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "RT_O5": """
        CREATE TABLE IF NOT EXISTS RT_O5 (
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "RT_O6": """
        CREATE TABLE IF NOT EXISTS RT_O6 (
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Kumi TEXT,
            Odds REAL,
            Ninki INTEGER,
            Field11 TEXT,
            Field12 TEXT,
            Field13 TEXT,
            Field14 TEXT,
            Field15 TEXT,
            Field16 TEXT,
            Field17 TEXT,
            Field18 TEXT,
            Field19 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Kumi)
        )
    """,
    "RT_RA": """
        CREATE TABLE IF NOT EXISTS RT_RA (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            YoubiCD TEXT,
            TokuNum TEXT,
            Hondai TEXT,
            Fukudai TEXT,
            Kakko TEXT,
            HondaiEng TEXT,
            FukudaiEng TEXT,
            KakkoEng TEXT,
            Ryakusyo10 TEXT,
            Ryakusyo6 TEXT,
            Ryakusyo3 TEXT,
            Kubun TEXT,
            Nkai TEXT,
            GradeCD TEXT,
            GradeCDBefore TEXT,
            SyubetuCD TEXT,
            KigoCD TEXT,
            JyuryoCD TEXT,
            JyokenCD1 TEXT,
            JyokenCD2 TEXT,
            JyokenCD3 TEXT,
            JyokenCD4 TEXT,
            JyokenCD5 TEXT,
            JyokenName TEXT,
            Kyori INTEGER,
            KyoriBefore INTEGER,
            TrackCD TEXT,
            TrackCDBefore TEXT,
            CourseKubunCD TEXT,
            CourseKubunCDBefore TEXT,
            Honsyokin1 REAL,
            Honsyokin2 REAL,
            Honsyokin3 REAL,
            Honsyokin4 REAL,
            Honsyokin5 REAL,
            Honsyokin6 REAL,
            Honsyokin7 REAL,
            HonsyokinBefore1 REAL,
            HonsyokinBefore2 REAL,
            HonsyokinBefore3 REAL,
            HonsyokinBefore4 REAL,
            HonsyokinBefore5 REAL,
            Fukasyokin1 REAL,
            Fukasyokin2 REAL,
            Fukasyokin3 REAL,
            Fukasyokin4 REAL,
            Fukasyokin5 REAL,
            FukasyokinBefore1 REAL,
            FukasyokinBefore2 REAL,
            FukasyokinBefore3 REAL,
            HassoTime TEXT,
            HassoTimeBefore TEXT,
            TorokuTosu INTEGER,
            SyussoTosu INTEGER,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum)
        )
    """,
    "RT_SE": """
        CREATE TABLE IF NOT EXISTS RT_SE (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year INTEGER,
            MonthDay INTEGER,
            JyoCD TEXT,
            Kaiji INTEGER,
            Nichiji INTEGER,
            RaceNum INTEGER,
            Wakuban INTEGER,
            Umaban INTEGER,
            KettoNum TEXT,
            Bamei TEXT,
            UmaKigoCD TEXT,
            SexCD TEXT,
            HinsyuCD TEXT,
            KeiroCD TEXT,
            Barei INTEGER,
            TozaiCD TEXT,
            ChokyosiCode TEXT,
            ChokyosiRyakusyo TEXT,
            BanusiCode TEXT,
            BanusiName TEXT,
            Fukusyoku TEXT,
            reserved1 TEXT,
            Futan REAL,
            FutanBefore REAL,
            Blinker TEXT,
            reserved2 TEXT,
            KisyuCode TEXT,
            KisyuCodeBefore TEXT,
            KisyuRyakusyo TEXT,
            KisyuRyakusyoBefore TEXT,
            MinaraiCD TEXT,
            MinaraiCDBefore TEXT,
            BaTaijyu REAL,
            ZogenFugo TEXT,
            ZogenSa REAL,
            IJyoCD TEXT,
            NyusenJyuni INTEGER,
            KakuteiJyuni INTEGER,
            DochakuKubun TEXT,
            DochakuTosu INTEGER,
            Time REAL,
            ChakusaCD TEXT,
            ChakusaCDP TEXT,
            ChakusaCDPP TEXT,
            Jyuni1c INTEGER,
            Jyuni2c INTEGER,
            Jyuni3c INTEGER,
            Jyuni4c INTEGER,
            Odds REAL,
            Ninki INTEGER,
            Honsyokin REAL,
            Fukasyokin REAL,
            reserved3 TEXT,
            reserved4 TEXT,
            HaronTimeL4 REAL,
            HaronTimeL3 REAL,
            KettoNum1 TEXT,
            Bamei1 TEXT,
            TimeDiff REAL,
            RecordUpKubun TEXT,
            DMKubun TEXT,
            DMTime REAL,
            DMGosaP REAL,
            DMGosaM REAL,
            DMJyuni INTEGER,
            KyakusituKubun TEXT,
            reserved5 TEXT,
            PRIMARY KEY (Year, MonthDay, JyoCD, Kaiji, Nichiji, RaceNum, Umaban)
        )
    """,
    "RT_TC": """
        CREATE TABLE IF NOT EXISTS RT_TC (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            HappyoTime TEXT,
            AtoJi TEXT,
            AtoFun TEXT,
            MaeJi TEXT,
            MaeFun TEXT
        )
    """,
    "RT_TM": """
        CREATE TABLE IF NOT EXISTS RT_TM (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            RaceNum TEXT,
            MakeHM TEXT,
            Umaban1 TEXT,
            TMScore1 TEXT,
            Umaban2 TEXT,
            TMScore2 TEXT
        )
    """,
    "RT_WE": """
        CREATE TABLE IF NOT EXISTS RT_WE (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            HappyoTime TEXT,
            HenkoID TEXT,
            TenkoState TEXT,
            SibaBabaState TEXT,
            DirtBabaState TEXT,
            TenkoState2 TEXT,
            SibaBabaState2 TEXT,
            DirtBabaState2 TEXT
        )
    """,
    "RT_WH": """
        CREATE TABLE IF NOT EXISTS RT_WH (
            RecordSpec TEXT,
            DataKubun TEXT,
            MakeDate TEXT,
            Year TEXT,
            MonthDay TEXT,
            JyoCD TEXT,
            Kaiji TEXT,
            Nichiji TEXT,
            HappyoTime TEXT,
            HenkoID TEXT,
            AtoTenkoCD TEXT,
            AtoSibaBabaCD TEXT,
            AtoDirtBabaCD TEXT,
            MaeTenkoCD TEXT,
            MaeSibaBabaCD TEXT,
            MaeDirtBabaCD TEXT
        )
    """
}


def create_all_tables(db: BaseDatabase) -> None:
    """Create all tables defined in SCHEMAS.

    Args:
        db: Database instance
    """
    logger.info("Creating tables...")
    for table_name, schema_sql in SCHEMAS.items():
        try:
            db.execute(schema_sql)
            logger.debug(f"Created table: {table_name}")
        except Exception as e:
            logger.error(f"Failed to create table {table_name}: {e}")
            raise
    logger.info(f"Successfully created {len(SCHEMAS)} tables")